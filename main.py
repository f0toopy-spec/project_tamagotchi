# Импорт необходимых модулей
import pygame  # Основная библиотека для создания игр
import os      # Работа с файловой системой
import sys     # Системные функции и работа с путями

# Добавляем текущую директорию в путь поиска Python модулей
current_dir = os.path.dirname(os.path.abspath(__file__))  # Получаем абсолютный путь текущего файла
sys.path.insert(0, current_dir)  # Добавляем в начало пути поиска модулей

# Импортируем конфигурационные константы из модуля config
from config import SCREEN_WIDTH, SCREEN_HEIGHT  # Ширина и высота игрового окна


def main():
    """
    Главная функция приложения.
    Инициализирует игровой движок Pygame, создаёт окно и запускает основной игровой цикл.
    Обрабатывает критические ошибки и предоставляет информацию о них.
    """
    try:
        # Инициализация всех модулей Pygame
        pygame.init()
        
        # Создание игрового окна с заданными размерами
        screen = pygame.display.set_mode((SCREEN_WIDTH, SCREEN_HEIGHT))
        
        # Установка заголовка окна
        pygame.display.set_caption("Tamagotchi Pou - Virtual Pet Game")

        # Логирование начала запуска игры
        print(" Starting Tamagotchi Pou...")

        # Импорт основного игрового ядра после настройки путей
        # Это делается здесь для избежания циклических импортов
        from game.core import GameCore  # Основной класс управления игрой

        # Создание экземпляра игрового ядра с передачей ссылки на экран
        game = GameCore(screen)
        
        # Запуск основного игрового цикла
        game.run()

    except Exception as e:
        """
        Обработчик критических ошибок.
        Захватывает любые непредвиденные исключения в процессе работы игры.
        """
        # Вывод сообщения об ошибке
        print(f" Error starting game: {e}")
        
        # Полный вывод стектрейса для диагностики
        import traceback
        traceback.print_exc()
        
        # Ожидание нажатия Enter перед завершением (для отладки в Windows)
        input("Press Enter to exit...")


# Точка входа в приложение
if __name__ == "__main__":
    """
    Стандартная проверка для Python скриптов.
    Гарантирует, что функция main() выполнится только при прямом запуске файла,
    а не при импорте как модуля.
    """
    main()  # Вызов главной функции